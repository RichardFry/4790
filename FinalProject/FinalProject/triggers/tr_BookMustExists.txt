--tr_AuthorMustExists
--Ian Suddreth 8/1/2016


GO

IF OBJECT_ID ('tr_BookMustExist', 'TR') IS NOT NULL  
   DROP TRIGGER tr_BookMustExist;
    
GO 

Create Trigger tr_BookMustExist  ON Rental
AFTER INSERT, UPDATE 
AS 
DECLARE @BookID smallint 
IF Exists ( SELECT * 
            FROM Inserted i 
			LEFT JOIN Book b ON i.BookID = b.BookID
			WHERE b.BookID is NULL ) 
BEGIN
SELECT @BookID = (SELECT BookID FROM Inserted) 
RAISERROR ('That book doesn''t Exist!',16,1,@BookID) 
ROLLBACK 
END