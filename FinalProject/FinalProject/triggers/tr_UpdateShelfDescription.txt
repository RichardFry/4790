--tr_UpdateShelfDescription
--Ian Suddreth 8/1/2016

GO

IF OBJECT_ID ('tr_UpdateShelfDescription', 'TR') IS NOT NULL  
   DROP TRIGGER tr_UpdateShelfDescription;
    
GO 

Create Trigger tr_UpdateShelfDescription  ON Shelf
INSTEAD OF INSERT
AS 
BEGIN
	DECLARE @Description varchar(100)
	DECLARE @HotelID smallint
	SET @HotelID = (SELECT i.HotelID FROM inserted i)

	SET @Description = (SELECT t.HotelName FROM OPENQUERY (TITAN_SUDDRETH, 'SELECT * FROM Hotel') t  WHERE t.HotelID = @HotelID) + ' ' + (SELECT i.ShelfLocation FROM inserted i)

	INSERT INTO Shelf SELECT i.HotelID, i.ShelfName, i.ShelfLocation, @Description FROM inserted i

END
