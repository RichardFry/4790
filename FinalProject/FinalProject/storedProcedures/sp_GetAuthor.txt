--sp_GetAuthor
--Ian Suddreth 8/1/2016

IF EXISTS(SELECT * FROM INFORMATION_SCHEMA.ROUTINES WHERE SPECIFIC_NAME = 'sp_GetAuthor')
	DROP PROCEDURE sp_GetAuthor;

GO 

CREATE PROCEDURE sp_GetAuthor
(
	@PublisherID smallint OUTPUT
)
AS 
BEGIN

	SELECT DISTINCT p.PublisherName, a.AuthorName
	FROM Author a
	JOIN BookAuthor ba ON ba.AuthorID = a.AuthorID 
	JOIN Book b ON b.BookID = ba.BookID
	JOIN Publisher p ON p.PublisherID = b.PublisherID
	WHERE b.PublisherID = @PublisherID

	RETURN
END